# hokka-beaver-quiz 400人規模運用時の費用計算書

## 📊 データ規模想定

### 基本データ構造（現状3人 → 400人スケール）

| テーブル | 現状レコード数 | 400人想定 | 1レコード平均 | 総容量想定 |
|----------|---------------|-----------|---------------|------------|
| users | 3 | 400 | ~5.5KB | 2.2MB |
| questions | 10 | 10 | ~1.6KB | 16KB |
| user_answers | 0 | 4,000 | ~0.5KB | 2MB |
| rankings | 0 | 400 | ~0.3KB | 120KB |
| quiz_completions | 0 | 400 | ~0.8KB | 320KB |
| survey_answers | 0 | 200 | ~0.5KB | 100KB |

**総データ容量**: 約4.8MB（インデックス含む：約10MB）

## 💰 AWS費用詳細計算（東京リージョン）

### 1. RDS MySQL費用

#### インスタンス費用（db.t3.micro）
- **基本料金**: $0.017/時間
- **月額**: $0.017 × 24 × 30 = $12.24/月
- **円換算**: ¥12.24 × 150 = **¥1,836/月**

#### ストレージ費用（汎用SSD）
- **データ容量**: 10MB（最小20GB課金）
- **料金**: $0.115/GB/月
- **月額**: $0.115 × 20 = $2.30/月
- **円換算**: ¥2.30 × 150 = **¥345/月**

#### バックアップ費用
- **自動バックアップ**: 20GB × 7日（無料枠内）
- **追加費用**: **¥0/月**

### 2. EC2費用

#### インスタンス費用（t3.micro）
- **基本料金**: $0.0104/時間
- **月額**: $0.0104 × 24 × 30 = $7.49/月
- **円換算**: ¥7.49 × 150 = **¥1,124/月**

#### EBS費用（汎用SSD）
- **容量**: 8GB
- **料金**: $0.10/GB/月
- **月額**: $0.10 × 8 = $0.80/月
- **円換算**: ¥0.80 × 150 = **¥120/月**

#### Elastic IP費用
- **料金**: $0.005/時間（割り当て済み）
- **月額**: $0.005 × 24 × 30 = $3.60/月
- **円換算**: ¥3.60 × 150 = **¥540/月**

### 3. 通信費用

#### データ転送費用（アウトバウンド）
- **400人 × 10問 × 平均10KB** = 40MB/人
- **月間総転送量**: 400人 × 40MB = 16GB
- **料金**: 1GB無料、15GB × $0.09 = $1.35/月
- **円換算**: ¥1.35 × 150 = **¥203/月**

## 📋 月額費用サマリー（400人規模）

| サービス | 費用（円/月） | 割合 |
|----------|---------------|------|
| RDS MySQL | ¥1,836 | 41% |
| RDS Storage | ¥345 | 8% |
| EC2 Instance | ¥1,124 | 25% |
| EBS Storage | ¥120 | 3% |
| Elastic IP | ¥540 | 12% |
| Data Transfer | ¥203 | 5% |
| その他 | ¥300 | 6% |
| **月額合計** | **¥4,468** | **100%** |

## 💡 費用最適化案

### 低コスト構成（¥2,500/月程度）

1. **RDSをインメモリ+JSONに戻す**: -¥2,181/月
2. **t3.microをt2.nanoに変更**: -¥600/月
3. **固定IPをDynamic DNSに変更**: -¥540/月

### 中コスト構成（¥3,500/月程度）

1. **RDS Reservedインスタンス（1年契約）**: -¥600/月
2. **EBS最適化**: -¥50/月
3. **CloudFront使用でトラフィック削減**: -¥100/月

## 🎯 利用者1人あたりコスト

- **400人規模**: ¥4,468 ÷ 400人 = **¥11.2/人/月**
- **200人規模**: ¥3,500 ÷ 200人 = **¥17.5/人/月**
- **100人規模**: ¥3,200 ÷ 100人 = **¥32/人/月**

## ⚡ パフォーマンス考慮

### 同時アクセス処理能力
- **t3.micro**: 50-100人同時接続
- **t3.small**: 200-400人同時接続（+¥2,000/月）

### 推奨構成（400人規模）
- **EC2**: t3.small（安定性向上）
- **RDS**: db.t3.micro（現行で十分）
- **総費用**: **¥6,500/月**

## 📈 スケール別費用予測

| 利用者数 | 月額費用（円） | 1人当たり（円） | 推奨構成 |
|----------|---------------|----------------|----------|
| 100人 | ¥3,200 | ¥32 | 現行構成 |
| 200人 | ¥3,800 | ¥19 | t3.small推奨 |
| 400人 | ¥4,500 | ¥11 | t3.small+監視 |
| 800人 | ¥8,000 | ¥10 | 冗長構成必要 |

---

**計算基準**:
- USD/JPY = 150円
- 東京リージョン価格
- 2025年8月時点のAWS料金
- 文化祭期間（3日間）の集中利用を考慮した安全マージン込み

**注意**: 実際の費用は利用パターンやAWS料金変動により変動する可能性があります。